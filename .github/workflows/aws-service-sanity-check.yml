name: Main Branch Checks

on:
  push:
    branches-ignore:
      - 'main'
      - 'docs'

jobs:
  verify-documentation-links:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Verify documentation files and links
        run: |
          missing_count=0
          while read -r file; do
            if [ ! -f "$file" ]; then
              missing_files="$missing_files $file"
            fi
          done < utils/doc-links.txt
          
          if [ $missing_count -gt 0 ]; then
            echo "❌ Missing files referenced in AWS documentation:"
            echo "Instructions:"
            echo "  These files are required for AWS services or documentations. Restore missing files or update documentation before merge."
            echo "  Refer to team wiki "AWS Service and Documentation Links" for details. "
            exit 1
          else
            echo "✅ All documentation-referenced files exist"
          fi
